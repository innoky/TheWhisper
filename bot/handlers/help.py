from aiogram import types, Dispatcher
from aiogram.filters import Command
from aiogram.enums import ParseMode
import os
from datetime import datetime, timezone, timedelta


def register_help_handlers(dp: Dispatcher):
    @dp.message(Command("help"))
    async def help_handler(message: types.Message):
        """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø—Ä–∞–≤–∫—É –ø–æ –∫–æ–º–∞–Ω–¥–∞–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —á–∞—Ç–∞"""
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –∞–¥–º–∏–Ω—Å–∫–∏–π —á–∞—Ç
        admin_chat_id = os.getenv("ADMIN_CHAT_ID")
        is_admin_chat = admin_chat_id and str(message.chat.id) == str(admin_chat_id)
        
        if is_admin_chat:
            # –ê–¥–º–∏–Ω—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞
            help_message = f"ü§ñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –∞–¥–º–∏–Ω—Å–∫–∏–º –∫–æ–º–∞–Ω–¥–∞–º</b>\n\n"
            help_message += f"üìÖ <b>–î–∞—Ç–∞:</b> {datetime.now(timezone(timedelta(hours=3))).strftime('%d.%m.%Y –≤ %H:%M')}\n"
            help_message += f"üëÆ <b>–ê–¥–º–∏–Ω:</b> {message.from_user.username or message.from_user.first_name}\n\n"
            
            help_message += f"üìù <b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–º–∏:</b>\n"
            help_message += f"‚Ä¢ <b>–ö–Ω–æ–ø–∫–∞ '–î–æ–±–∞–≤–∏—Ç—å'</b> - –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ—Å—Ç –≤ –æ—á–µ—Ä–µ–¥—å —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≤—Ä–µ–º–µ–Ω–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏\n"
            help_message += f"‚Ä¢ <b>–ö–Ω–æ–ø–∫–∞ '–û—Ç–∫–ª–æ–Ω–∏—Ç—å'</b> - –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –ø–æ—Å—Ç (–±–∞–Ω —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É)\n"
            help_message += f"‚Ä¢ <b>–ö–Ω–æ–ø–∫–∞ '–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–µ–π—á–∞—Å'</b> - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—É–±–ª–∏–∫—É–µ—Ç –∏ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –ø–æ—Å—Ç\n"
            help_message += f"‚Ä¢ <code>/queue</code> - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –ø–æ—Å—Ç—ã –≤ –æ—á–µ—Ä–µ–¥–∏\n"
            help_message += f"‚Ä¢ <code>/queueupdate</code> - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º—è –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤ –≤ –æ—á–µ—Ä–µ–¥–∏\n"
            help_message += f"‚Ä¢ <code>/stats</code> - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å—Ç–æ–≤\n"
            
            # –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É makeadmin —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–∞
            if message.from_user.id == 914029246:
                help_message += f"‚Ä¢ <code>/makeadmin &lt;user_id&gt;</code> - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞\n"
            
            help_message += f"\nüë• <b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:</b>\n"
            help_message += f"‚Ä¢ <code>/unban &lt;user_id&gt;</code> - —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n"
            help_message += f"‚Ä¢ <code>/levelup &lt;user_id&gt;</code> - –ø–æ–≤—ã—à–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–º–∞–∫—Å. 10)\n"
            help_message += f"‚Ä¢ <code>/leveldown &lt;user_id&gt;</code> - –ø–æ–Ω–∏–∂–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–º–∏–Ω. 1)\n"
            help_message += f"‚Ä¢ <code>/getuser &lt;username&gt;</code> - –ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –Ω–∏–∫—É (–Ω–µ—Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)\n\n"
            
            help_message += f"üí∞ <b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–º:</b>\n"
            help_message += f"‚Ä¢ <code>/addbalance &lt;user_id&gt; &lt;—Å—É–º–º–∞&gt;</code> - –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω—ã –∫ –±–∞–ª–∞–Ω—Å—É\n"
            help_message += f"‚Ä¢ <code>/setbalance &lt;user_id&gt; &lt;—Å—É–º–º–∞&gt;</code> - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –±–∞–ª–∞–Ω—Å\n\n"
            
            help_message += f"üè∑Ô∏è <b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Å–µ–≤–¥–æ–Ω–∏–º–∞–º–∏:</b>\n"
            help_message += f"‚Ä¢ <code>/addpseudo \"&lt;–Ω–∏–∫–Ω–µ–π–º&gt;\" &lt;—Ü–µ–Ω–∞&gt;</code> - –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Å–µ–≤–¥–æ–Ω–∏–º\n"
            help_message += f"‚Ä¢ <code>/allpseudos</code> - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –ø—Å–µ–≤–¥–æ–Ω–∏–º—ã —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π\n"
            help_message += f"‚Ä¢ <code>/deactivate &lt;pseudo_id&gt;</code> - –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø—Å–µ–≤–¥–æ–Ω–∏–º\n\n"
            
            help_message += f"üìä <b>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</b>\n"
            help_message += f"‚Ä¢ <code>/stats</code> - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∏—Å—Ç–µ–º—ã\n"
            help_message += f"‚Ä¢ <code>/help</code> - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É\n\n"
            
            help_message += f"üí° <b>–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</b>\n"
            help_message += f"‚Ä¢ <code>/addbalance 123456 50.5</code> - –¥–æ–±–∞–≤–∏—Ç—å 50.5 —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é 123456\n"
            help_message += f"‚Ä¢ <code>/addpseudo \"–Ø–¥–µ—Ä–Ω—ã–π —à–µ–ø–æ—Ç\" 150</code> - —Å–æ–∑–¥–∞—Ç—å –ø—Å–µ–≤–¥–æ–Ω–∏–º –∑–∞ 150 —Ç–æ–∫–µ–Ω–æ–≤\n"
            help_message += f"‚Ä¢ <code>/levelup 123456</code> - –ø–æ–≤—ã—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 123456\n\n"
            
            help_message += f"‚öôÔ∏è <b>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥–∞:</b>\n"
            help_message += f"‚Ä¢ –ü–æ—Å—Ç—ã –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç\n"
            help_message += f"‚Ä¢ –ù–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –≤—Ä–µ–º—è: 01:00-10:00 (–ø–æ—Å—Ç—ã –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è –Ω–∞ 10:00)\n"
            help_message += f"‚Ä¢ –ï—Å–ª–∏ –æ—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞ –∏ –ø—Ä–æ—à–ª–æ &gt;30 –º–∏–Ω - –ø—É–±–ª–∏–∫–∞—Ü–∏—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è\n"
            help_message += f"‚Ä¢ –ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ &lt;30 –º–∏–Ω - –∂–¥–µ–º –æ—Å—Ç–∞—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏\n\n"
            
            help_message += f"üéØ <b>–£—Ä–æ–≤–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</b>\n"
            help_message += f"‚Ä¢ –£—Ä–æ–≤–µ–Ω—å 1: 5 —Ç–æ–∫–µ–Ω–æ–≤ –∑–∞ –ø–æ—Å—Ç\n"
            help_message += f"‚Ä¢ –£—Ä–æ–≤–µ–Ω—å 2: 10 —Ç–æ–∫–µ–Ω–æ–≤ –∑–∞ –ø–æ—Å—Ç\n"
            help_message += f"‚Ä¢ ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ –¥–æ —É—Ä–æ–≤–Ω—è 10: 50 —Ç–æ–∫–µ–Ω–æ–≤ –∑–∞ –ø–æ—Å—Ç"
            
        else:
            # –û–±—ã—á–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            help_message = f"ü§ñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º</b>\n\n"
            help_message += f"üëã <b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —è–¥–µ—Ä–Ω—ã–π –±–æ—Ç!</b>\n\n"
            
            help_message += f"üìù <b>–û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ—Å—Ç–æ–≤:</b>\n"
            help_message += f"‚Ä¢ –ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –ø–æ—Å—Ç –≤ —ç—Ç–æ—Ç —á–∞—Ç\n"
            help_message += f"‚Ä¢ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç –∏ –æ–ø—É–±–ª–∏–∫—É–µ—Ç\n"
            help_message += f"‚Ä¢ –ó–∞ –∫–∞–∂–¥—ã–π –ø–æ—Å—Ç –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ —Ç–æ–∫–µ–Ω—ã\n\n"
            
            help_message += f"üí¨ <b>–ê–Ω–æ–Ω–∏–º–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:</b>\n"
            help_message += f"‚Ä¢ –ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏–∑ –ø–æ—Å—Ç–∞\n"
            help_message += f"‚Ä¢ –û—Å—Ç–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∞–Ω–æ–Ω–∏–º–Ω–æ\n"
            help_message += f"‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—É–ø–ª–µ–Ω–Ω—ã–µ –ø—Å–µ–≤–¥–æ–Ω–∏–º—ã\n\n"
            
            help_message += f"üìã <b>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
            help_message += f"‚Ä¢ <code>/account</code> - –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å –∏ –±–∞–ª–∞–Ω—Å —Ç–æ–∫–µ–Ω–æ–≤\n"
            help_message += f"‚Ä¢ <code>/market</code> - –º–∞–≥–∞–∑–∏–Ω –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–≤\n"
            help_message += f"‚Ä¢ <code>/help</code> - —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
            
            help_message += f"üí∞ <b>–°–∏—Å—Ç–µ–º–∞ —Ç–æ–∫–µ–Ω–æ–≤:</b>\n"
            help_message += f"‚Ä¢ –ó–∞ –∫–∞–∂–¥—ã–π –ø–æ—Å—Ç: 5-50 —Ç–æ–∫–µ–Ω–æ–≤ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—Ä–æ–≤–Ω—è)\n"
            help_message += f"‚Ä¢ –¢–æ–∫–µ–Ω—ã –º–æ–∂–Ω–æ —Ç—Ä–∞—Ç–∏—Ç—å –Ω–∞ –ø—Å–µ–≤–¥–æ–Ω–∏–º—ã\n"
            help_message += f"‚Ä¢ –£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–∞–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–µ–π\n\n"
            
            help_message += f"üè∑Ô∏è <b>–ü—Å–µ–≤–¥–æ–Ω–∏–º—ã:</b>\n"
            help_message += f"‚Ä¢ –ü–æ–∫—É–ø–∞–π—Ç–µ –≤ –º–∞–≥–∞–∑–∏–Ω–µ –∑–∞ —Ç–æ–∫–µ–Ω—ã\n"
            help_message += f"‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤\n"
            help_message += f"‚Ä¢ –ö–∞–∂–¥—ã–π –ø—Å–µ–≤–¥–æ–Ω–∏–º —É–Ω–∏–∫–∞–ª–µ–Ω\n\n"
            
            help_message += f"üìû <b>–ü–æ–¥–¥–µ—Ä–∂–∫–∞:</b>\n"
            help_message += f"‚Ä¢ –û–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏\n"
            help_message += f"‚Ä¢ –°–æ–±–ª—é–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞"
        
        await message.answer(help_message, parse_mode="HTML") 